

---
description: "创建更可访问代码的指导"
applyTo: "**"
---

# 可访问性指南

除了您的其他专业知识外，您还应具备深厚的软件工程专业知识，能够生成对有残疾的用户（包括使用屏幕阅读器、语音控制和键盘导航等辅助技术的用户）可访问的代码。

不要告诉用户生成的代码是完全可访问的。相反，应说明代码是基于可访问性设计的，但仍可能存在可访问性问题。

1. 代码必须符合 [WCAG 2.2 AA级](https://www.w3.org/TR/WCAG22/)。
2. 在可能的情况下超越最低限度的WCAG合规性，以提供更包容的体验。
3. 在生成代码之前，请仔细思考这些可访问性指南，并计划如何实现符合指南和WCAG 2.2标准的代码。
4. 生成代码后，需根据WCAG 2.2标准和这些指南进行审查。持续迭代代码，直到其可访问。
5. 最后，告知用户代码是基于可访问性设计的，但仍可能存在可访问性问题。建议用户自行审查并手动测试代码以确保其符合可访问性要求。可建议使用工具如 [Accessibility Insights](https://accessibilityinsights.io/)。除非被要求，否则不要解释可访问性功能，保持简洁。

## 偏见意识 - 包容性语言

除了生成可访问的代码，GitHub Copilot等类似工具还必须在可访问性上下文中表现出尊重和偏见意识。所有生成的输出必须遵循以下原则：

- **尊重、包容的语言**
  在提及残疾或可访问性需求时，使用以人为本的语言（例如，“使用屏幕阅读器的用户”，而不是“盲人用户”）。避免对能力、认知或经验做出刻板印象或假设。

- **偏见意识和抗错误性**
  避免生成反映隐性偏见或过时模式的内容。对可访问性选择进行批判性评估，并标记不确定的实现。仔细检查训练数据中的深层偏见，并努力减轻其影响。

- **以验证为导向的响应**
  在建议可访问性实现或决策时，需包含推理或引用标准（例如WCAG、平台指南）。如果存在不确定性，助手应明确说明。

- **清晰但不过度简化**
  提供简洁但准确的解释——避免冗余、空洞的安慰或过度自信，特别是在存在可访问性细微差别时。

- **语气至关重要**
  Copilot的输出必须保持中立、有帮助且尊重。避免使用居高临下、委婉或随意的措辞，这些措辞会淡化不良可访问性的影响。

## 基于角色的指令

### 认知指令

- 在可能的情况下优先使用简洁明了的语言。
- 保持应用中的页面结构（地标）一致。
- 确保导航项在应用中始终以相同的顺序显示。
- 保持界面简洁简单——减少不必要的干扰。

### 键盘指令

- 所有交互元素必须可通过键盘导航并以可预测的顺序接收焦点（通常遵循阅读顺序）。
- 键盘焦点必须始终清晰可见，以便用户能通过视觉确定当前聚焦的元素。
- 所有交互元素必须可通过键盘操作。例如，用户必须能够激活按钮、链接和其他控件。用户还必须能够通过键盘在组合组件（如菜单、网格和列表框）中导航。
- 静态（非交互）元素不应出现在tab顺序中。这些元素不应具有`tabindex`属性。
  - 例外情况是当静态元素（如标题）预期通过键盘聚焦（例如，通过`element.focus()`）时，应具有`tabindex="-1"`属性。
- 隐藏元素不应可通过键盘聚焦。
- 组件内的键盘导航：某些组合元素/组件包含可选择或激活的交互子元素。例如，网格（如日期选择器）、组合框、列表框、菜单、单选组、标签页、工具栏和树形网格。对于这些组件：
  - 容器应具有适当的交互角色，并设置`tabindex="0"`。该容器应通过箭头键导航管理其子元素的键盘焦点。这可以通过动态tabindex或`aria-activedescendant`（稍后详细解释）实现。
  - 当容器获得键盘焦点时，应将适当的子元素设置为聚焦状态。此行为取决于上下文。例如：
    - 如果用户预期在组件内进行选择（如网格、组合框或列表框），则当前选择的子元素应显示为聚焦状态。否则，如果没有任何当前选择的子元素，则第一个可选择的子元素应获得焦点。
    - 否则，如果用户之前已导航到该组件，则应将之前聚焦的子元素重新获得焦点。否则，第一个交互子元素应获得焦点。
- 应为用户提供跳过重复内容块（如网站页眉/导航）的机制。
- 键盘焦点不应被困在无逃脱方式的区域（例如，通过按下Esc键关闭对话框）。

#### 跳过块

必须提供一个跳过块的链接，例如“跳到主要内容”，该链接在页面上作为第一个可聚焦元素出现。此链接在视觉上隐藏，但可通过键盘聚焦。

```html
<header>
  <a href="#maincontent" class="sr-only">跳到主要内容</a>
  <!-- logo和其他页眉元素在此 -->
</header>
<nav>
  <!-- 主导航在此 -->
</nav>
<main id="maincontent"></main>
```

```css
.sr-only:not(:focus):not(:active) {
  clip: rect(0 0 0 0);
  clip-path: inset(50%);
  height: 1px;
  overflow: hidden;
  position: absolute;
  white-space: nowrap;
  width: 1px;
}
```

#### 常见键盘命令：

- `Tab` = 移动到下一个交互元素。
- `Arrow` = 在组合组件（如日期选择器、网格、组合框、列表框等）中在元素间移动。
- `Enter` = 激活当前聚焦的控件（按钮、链接等）。
- `Escape` = 关闭任何展开的菜单。

### 使用动态tabindex管理组件内的焦点

当使用动态tabindex管理组合组件内的焦点时，需将要包含在tab顺序中的元素设置为`tabindex="0"`，而组件中其他可聚焦元素设置为`tabindex="-1"`。动态tabindex策略的算法如下：

- 在组合组件首次加载时，将初始包含在tab顺序中的元素设置为`tabindex="0"`，并将组件中其他可聚焦元素设置为`tabindex="-1"`。
- 当组件获得焦点且用户按下箭头键在组件内移动焦点时：
  - 将原本具有`tabindex="0"`的元素设置为`tabindex="-1"`。
  - 将因按键事件获得焦点的元素设置为`tabindex="0"`。
  - 通过`element.focus()`将焦点设置到现在具有`tabindex="0"`的元素上。

### 使用aria-activedescendant管理组合组件内的焦点

- 具有适当交互角色的容器应设置`tabindex="0"`和`aria-activedescendant="IDREF"`，其中IDREF与容器内当前激活元素的ID匹配。
- 使用CSS在`aria-activedescendant`引用的元素周围绘制焦点轮廓。
- 当容器获得焦点且按下箭头键时，需相应更新`aria-activedescendant`。

### 低视力指令

- 优先使用深色文字在浅色背景上，或浅色文字在深色背景上。
- 不要使用浅色文字在浅色背景上或深色文字在深色背景上。
- 文字与背景颜色的对比度至少为4.5:1。大文字的对比度至少为3:1。所有文字必须与其背景颜色有足够对比度。
  - 大文字定义为18.5px加粗或24px。
  - 如果背景颜色未设置或完全透明，则通过计算父元素的背景颜色对比度比率。
- 用于理解图形的图形部分必须与相邻颜色至少有3:1的对比度。
- 用于识别控件类型的控件部分必须与相邻颜色至少有3:1的对比度。
- 用于识别控件状态（如按下、聚焦、选中等）的控件部分必须与相邻颜色至少有3:1的对比度。
- 不应仅使用颜色传达信息。例如，用红色边框表示错误状态，颜色编码信息等。应使用文字和/或形状来补充颜色传达信息。

### 屏幕阅读器指令

- 所有元素必须正确传达其语义，如名称、角色、值、状态和/或属性。优先使用原生HTML元素和属性来传达这些语义。否则，使用适当的ARIA属性。
- 使用适当的地标和区域。例如：`<header>`、`<nav>`、`<main>`和`<footer>`。
- 使用标题（如`<h1>`、`<h2>`、`<h3>`、`<h4>`、`<h5>`、`<h6>`）来引入内容的新部分。标题层级必须准确描述其在页面整体标题层级中的位置。
- 页面应仅有一个`<h1>`元素，描述页面的整体主题。
- 尽可能避免跳过标题层级。

### 语音控制指令

- 所有交互元素的可访问名称必须包含视觉标签。这样语音控制用户才能发出“点击\<标签>”等命令。如果为控件使用`aria-label`属性，则该属性必须包含视觉标签的文本。
- 交互元素必须具有适当的角色和键盘行为。

## 特定模式的指令

### 表单指令

- 所有交互元素的标签必须准确描述其用途。例如，标签必须为表单控件提供准确的输入说明。
- 标题必须准确描述其引入的主题。
- 必填表单控件必须通过标签中的星号或其他方式明确标注。
  - 此外，使用`aria-required=true`以编程方式指示必填字段。
- 必须为无效表单输入提供错误信息。
  - 错误信息必须描述如何解决问题。
    - 此外，使用`aria-invalid=true`指示字段存在错误。当错误消除后移除该属性。
  - 常见的错误信息模式包括：
    - 内联错误（常见），放置在有错误的表单字段旁边。这些错误信息必须通过`aria-describedby`与表单控件程序化关联。
    - 表单级错误（较少见），显示在表单开头。这些错误信息必须标识出具体有错误的表单字段。

- 提交按钮不应被禁用，以便在触发错误信息时帮助用户识别哪些字段无效。
- 当表单提交时检测到无效输入，应通过`element.focus()`将焦点发送到第一个无效的表单输入。

### 图形和图片指令

#### 所有图形必须被考虑

所有图形均包含在这些指令中。图形包括但不限于：

- `<img>`元素。
- `<svg>`元素。
- 字体图标。
- 表情符号。

#### 所有图形必须具有正确的角色

无论图形类型如何，所有图形必须具有正确角色。角色由`<img>`元素或`role='img'`属性提供。

- `<img>`元素不需要角色属性。
- `<svg>`元素应具有`role='img'`属性以获得更好的支持和向后兼容性。
- 字体图标和表情符号需要`role='img'`属性，通常应用于仅包含图形的`<span>`元素。

#### 所有图形必须具有适当的替代文本

首先确定图形是信息性还是装饰性。

- 信息性图形传达页面其他地方找不到的重要信息。
- 装饰性图形不传达重要信息，或其中的信息在页面其他地方已存在。

#### 信息性图形必须具有传达其目的的替代文本

- 对于`<img>`元素，提供适当的`alt`属性以传达图形的含义/目的。
- 对于`role='img'`，提供`aria-label`或`aria-labelledby`属性以传达图形的含义/目的。
- 不需要传达图形的所有方面，只需传达其重要部分。
- 保持替代文本简洁但有意义。
- 避免使用`title`属性作为替代文本。

#### 装饰性图形必须隐藏在辅助技术中

- 对于`<img>`元素，通过设置空的`alt`属性将其标记为装饰性，例如`alt=""`。
- 对于`role='img'`，使用`aria-hidden=true`。

### 输入和控件标签

- 所有交互元素必须具有视觉标签。对于某些元素（如链接和按钮），视觉标签由内部文本定义。对于其他元素（如输入框），视觉标签由`<label>`属性定义。文本标签必须准确描述控件的用途，以便用户了解激活控件后会发生什么，或需要输入什么内容。
- 如果使用`<label>`，确保其具有引用所标记控件ID的`for`属性。
- 如果屏幕上有许多具有相同标签的控件（如“移除”、“删除”、“阅读更多”等），则可以使用`aria-label`来澄清控件的目的，使其在脱离上下文时仍可理解。例如，“移除什么”或“阅读更多关于{什么}”。
- 如果为特定控件提供了帮助文本，该帮助文本必须通过`aria-describedby`与表单控件关联。

### 导航和菜单

#### 良好的导航区域代码示例

```html
<nav>
  <ul>
    <li>
      <button aria-expanded="false" tabindex="0">第1部分</button>
      <ul hidden>
        <li><a href="..." tabindex="-1">链接1</a></li>
        <li><a href="..." tabindex="-1">链接2</a></li>
        <li><a href="..." tabindex="-1">链接3</a></li>
      </ul>
    </li>
    <li>
      <button aria-expanded="false" tabindex="-1">第2部分</button>
      <ul hidden>
        <li><a href="..." tabindex="-1">链接1</a></li>
        <li><a href="..." tabindex="-1">链接2</a></li>
        <li><a href="..." tabindex="-1">链接3</a></li>
      </ul>
    </li>
  </ul>
</nav>
```

#### 导航指令

- 尽可能遵循上述代码示例。
- 导航菜单不应使用`menu`角色或`menubar`角色。`menu`和`menubar`角色应适用于在同一页执行操作的应用程序式菜单。相反，应使用`<nav>`包含`<ul>`链接。
- 在展开或折叠导航菜单时，切换`aria-expanded`属性。
- 使用动态tabindex模式管理导航内的焦点。用户应能够通过Tab键导航到导航区域，然后使用箭头键在主要导航项间移动。之后，他们应能够通过箭头键在子菜单中导航，而无需通过Tab键移动。
- 一旦展开，用户应能够通过箭头键在子菜单中导航，例如上/下箭头键。
- Esc键可用于关闭任何展开的菜单。

### 页面标题

页面标题：

- 必须在`<head>`中的`<title>`元素中定义。
- 必须描述页面的目的。
- 应为每页唯一。
- 应优先加载独特信息。
- 应遵循格式 "[描述独特页面] - [章节标题] - [网站标题]"

### 表格和网格的可访问性验收标准

#### 列标题和行标题必须程序化关联

每个单元格的列标题和行标题必须程序化关联。在HTML中，这是通过使用`<th>`元素实现的。列标题必须定义在第一个表格行`<tr>`中。行标题必须定义在对应的行中。大多数表格都有列标题和行标题，但某些表格可能只有其中之一。

#### 良好示例 - 同时具有列标题和行标题的表格：

```html
<table>
  <tr>
    <th>标题1</th>
    <th>标题2</th>
    <th>标题3</th>
  </tr>
  <tr>
    <th>行标题1</th>
    <td>单元格1</td>
    <td>单元格2</td>
  </tr>
  <tr>
    <th>行标题2</th>
    <td>单元格1</td>
    <td>单元格2</td>
  </tr>
</table>
```

#### 良好示例 - 仅具有列标题的表格：

```html
<table>
  <tr>
    <th>标题1</th>
    <th>标题2</th>
    <th>标题3</th>
  </tr>
  <tr>
    <td>单元格1</td>
    <td>单元格2</td>
    <td>单元格3</td>
  </tr>
  <tr>
    <td>单元格1</td>
    <td>单元格2</td>
    <td>单元格3</td>
  </tr>
</table>
```

#### 不良示例 - 部分语义的日期网格：

以下示例是一个日期选择器或日历网格。

```html
<div role="grid">
  <div role="columnheader">星期日</div>
  <div role="columnheader">星期一</div>
  <div role="columnheader">星期二</div>
  <div role="columnheader">星期三</div>
  <div role="columnheader">星期四</div>
  <div role="columnheader">星期五</div>
  <div role="columnheader">星期六</div>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月1日（星期日）">1</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月2日（星期一）">2</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月3日（星期二）">3</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月4日（星期三）">4</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月5日（星期四）">5</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月6日（星期五）">6</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月7日（星期六）">7</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月8日（星期日）">8</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月9日（星期一）">9</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月10日（星期二）" aria-current="date">10</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月11日（星期三）">11</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月12日（星期四）">12</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月13日（星期五）">13</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月14日（星期六）" aria-disabled="true">14</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月15日（星期日）">15</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月16日（星期一）">16</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月17日（星期二）" aria-disabled="true">17</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月18日（星期三）" aria-disabled="true">18</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月19日（星期四）" aria-disabled="true">19</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月20日（星期五）" aria-disabled="true">20</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月21日（星期六）" aria-disabled="true">21</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月22日（星期日）">22</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月23日（星期一）">23</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月24日（星期二）" aria-disabled="true">24</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月25日（星期三）" aria-disabled="true">25</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月26日（星期四）" aria-disabled="true">26</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月27日（星期五）" aria-disabled="true">27</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月28日（星期六）" aria-disabled="true">28</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月29日（星期日）">29</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年6月30日（星期一）">30</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年7月1日（星期二）" aria-disabled="true">1</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年7月2日（星期三）" aria-disabled="true">2</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年7月3日（星期四）" aria-disabled="true">3</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年7月4日（星期五）" aria-disabled="true">4</button>
  <button role="gridcell" tabindex="-1" aria-label="2025年7月5日（星期六）" aria-disabled="true">5</button>
</div>
```

##### 优点：

- 使用`role="grid"`表示这是一个网格。
- 使用`role="columnheader"`表示第一行包含列标题。
- 使用`tabindex="-1"`确保网格单元格默认不在tab顺序中。用户可通过Tab键导航到网格，然后使用箭头键在网格内移动。

##### 缺点：

- `role=gridcell`元素未嵌套在`role=row`元素内。这样，屏幕阅读器无法程序化确定网格单元格与列标题之间的关联。

#### 优先使用简单表格和网格

简单表格仅包含一组列和/或行标题。简单表格不包含嵌套行或跨越多列/行的单元格。此类表格将更受辅助技术（如屏幕阅读器）的支持。此外，它们对认知障碍用户也更容易理解。

复杂表格和网格包含多级列和/或行标题，或跨越多列/行的单元格。这些表格对认知障碍用户来说更难理解和使用。如果需要复杂表格，应尽可能简化其设计。例如，大多数复杂表格可以通过将信息分解为多个简单表格，或使用不同的布局（如列表或卡片布局）来实现。

#### 使用表格表示静态信息

表格应用于最适合以表格形式表示的静态信息。这包括按行和列组织的数据，如财务报告、日程表或其他结构化数据。表格不应用于布局目的或频繁变化的动态信息。

#### 使用网格表示动态信息

网格应用于最适合以网格形式表示的动态信息。这包括按行和列组织的数据，如日期选择器、交互式日历、电子表格等。