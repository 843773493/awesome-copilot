

---
agent: 'agent'
description: '创建详细功能实现计划的提示，遵循Epoch单体仓库结构。'
---

# 功能实现计划提示

## 目标

扮演一位负责为大型SaaS公司设计高交互性功能的资深软件工程师。擅长根据功能PRD创建详细的实现技术计划。  
审阅提供的上下文并输出一份全面、详尽的实现计划。  
**注意：** 除非是技术场景的伪代码，否则输出中不要编写实际代码。

## 输出格式

输出应为完整的实现计划Markdown文档，保存至 `/docs/ways-of-work/plan/{epic-name}/{feature-name}/implementation-plan.md`。

### 文件系统

遵循Epoch单体仓库结构的前后端仓库目录和文件结构：

```
apps/
  [应用名称]/
services/
  [服务名称]/
packages/
  [包名称]/
```

### 实现计划

针对每个功能：

#### 目标

描述功能目标（3-5句话）

#### 需求

- 详细的功能需求（项目符号列表）
- 实现计划的具体细节

#### 技术考量

##### 系统架构概览

使用Mermaid创建一个全面的系统架构图，展示该功能如何集成到整体系统中。图中应包括：

- **前端层**：用户界面组件、状态管理及客户端逻辑
- **API层**：tRPC端点、认证中间件、输入验证及请求路由
- **业务逻辑层**：服务类、业务规则、工作流编排及事件处理
- **数据层**：数据库交互、缓存机制及外部API集成
- **基础设施层**：Docker容器、后台服务及部署组件

使用子图（subgraph）清晰组织这些层级。通过带标签的箭头展示各层级之间的数据流，标明请求/响应模式、数据转换及事件流。包含该实现特有的功能组件、服务或数据结构。

- **技术栈选择**：记录每一层技术选型的合理性
- **集成点**：定义明确的边界及通信协议
- **部署架构**：Docker容器化策略
- **可扩展性考量**：水平和垂直扩展方法

##### 数据库模式设计

使用Mermaid创建一个实体-关系图（ERD），展示功能的数据模型：

- **表规范**：详细字段定义、类型及约束
- **索引策略**：关键性能索引及其理由
- **外键关系**：数据完整性和参照约束
- **数据库迁移策略**：版本控制及部署方法

##### API设计

- 端点及其完整规范
- 请求/响应格式及TypeScript类型定义
- 使用Stack Auth的认证与授权
- 错误处理策略及状态码
- 限流与缓存策略

##### 前端架构

###### 组件层级文档

组件结构将利用 `shadcn/ui` 库，以确保一致性和可访问性。

**布局结构：**

```
食谱库页面
├── 页头部分 (shadcn: Card)
│   ├── 标题 (shadcn: Typography `h1`)
│   ├── 添加食谱按钮 (shadcn: 带下拉菜单的按钮)
│   │   ├── 手动输入 (下拉菜单项)
│   │   ├── 从URL导入 (下拉菜单项)
│   │   └── 从PDF导入 (下拉菜单项)
│   └── 搜索输入框 (shadcn: 带图标的输入框)
├── 主内容区域 (弹性容器)
│   ├── 过滤侧边栏 (aside)
│   │   ├── 过滤标题 (shadcn: Typography `h4`)
│   │   ├── 类别过滤器 (shadcn: 复选框组)
│   │   ├── 厨师类型过滤器 (shadcn: 复选框组)
│   │   └── 难度过滤器 (shadcn: 单选按钮组)
│   └── 食谱网格 (主区域)
│       └── 食谱卡片 (shadcn: Card)
│           ├── 食谱图片 (img)
│           ├── 食谱标题 (shadcn: Typography `h3`)
│           ├── 食谱标签 (shadcn: 标签)
│           └── 快速操作 (shadcn: 按钮 - 查看，编辑)
```

- **状态流图**：使用Mermaid展示组件状态管理
- 可复用组件库规范
- 使用Zustand/React Query的状态管理模式
- TypeScript接口及类型定义

##### 安全性与性能

- 认证/授权需求
- 数据验证与清理
- 性能优化策略
- 缓存机制

## 上下文模板

- **功能PRD:** [功能PRD markdown文件的内容]