---
name: powerbi-modeling
description: 'Power BI 语义建模助手，用于构建优化的数据模型。在处理 Power BI 语义模型、创建度量值、设计星型架构、配置关系、实现行级安全性（RLS）或优化模型性能时使用。当用户询问 DAX 计算、表关系、维度/事实表设计、命名规范、模型文档、基数、跨筛选方向、计算组和数据模型最佳实践时触发。始终首先使用 power-bi-modeling MCP 工具连接到当前活动的模型，以理解数据结构后再提供指导。'
---

# Power BI 语义建模

指导用户按照 Microsoft 最佳实践构建优化且文档齐全的 Power BI 语义模型。

## 使用此技能的场景

当用户询问以下内容时使用此技能：
- 创建或优化 Power BI 语义模型
- 设计星型架构（维度表/事实表）
- 编写 DAX 度量值或计算列
- 配置表关系（基数、跨筛选）
- 实现行级安全性（RLS）
- 表、列、度量值的命名规范
- 为模型添加描述和文档
- 性能调优和优化
- 计算组和字段参数
- 模型验证和最佳实践检查

**触发短语：** "创建度量值", "添加关系", "星型架构", "优化模型", "DAX 公式", "RLS", "命名规范", "模型文档", "基数", "跨筛选"

## 前提条件

### 必需工具
- **Power BI 语义建模 MCP 服务器**：用于连接和修改语义模型的必需工具
  - 支持：连接操作、表操作、度量值操作、关系操作等
  - 必须已配置并运行，才能与模型进行交互

### 可选依赖项
- **Microsoft Learn MCP 服务器**：推荐用于研究最新的最佳实践
  - 支持：Microsoft 文档搜索、Microsoft 文档获取
  - 用于复杂场景、新功能和官方文档

## 工作流程

### 1. 连接并分析模型

在提供任何建模指导之前，始终先检查当前模型状态：

```
1. 列出连接：connection_operations(operation: "ListConnections")
2. 如果没有连接，请检查本地实例：connection_operations(operation: "ListLocalInstances")
3. 连接到模型（桌面版或 Fabric）
4. 获取模型概览：model_operations(operation: "Get")
5. 列出表：table_operations(operation: "List")
6. 列出关系：relationship_operations(operation: "List")
7. 列出度量值：measure_operations(operation: "List")
```

### 2. 评估模型健康状况

连接后，根据最佳实践评估模型：
- **星型架构**：表是否正确分类为维度表或事实表？
- **关系**：基数是否正确？是否避免了不必要的双向筛选？
- **命名**：是否采用人类可读且一致的命名规范？
- **文档**：表、列、度量值是否都有描述？
- **度量值**：是否为关键计算显式定义了度量值？
- **隐藏字段**：技术列（如主键、ID）是否从报告视图中隐藏？

### 3. 提供针对性指导

根据分析结果，使用以下参考资料指导改进：
- 星型架构设计：参见 [STAR-SCHEMA.md](references/STAR-SCHEMA.md)
- 关系配置：参见 [RELATIONSHIPS.md](references/RELATIONSHIPS.md)
- DAX 度量值和命名：参见 [MEASURES-DAX.md](references/MEASURES-DAX.md)
- 性能优化：参见 [PERFORMANCE.md](references/PERFORMANCE.md)
- 行级安全性：参见 [RLS.md](references/RLS.md)

## 快速参考：模型质量检查清单

| 领域 | 最佳实践 |
|------|----------|
| 表 | 明确区分维度表和事实表 |
| 命名 | 人类可读：`Customer Name` 而非 `CUST_NM` |
| 描述 | 所有表、列、度量值均需文档说明 |
| 度量值 | 为业务指标显式定义 DAX 度量值 |
| 关系 | 从维度表到事实表的单向一对多关系 |
| 跨筛选 | 除非特别需要，否则保持单向筛选 |
| 隐藏字段 | 隐藏技术主键、ID 等字段 |
| 日期表 | 专用的标记日期表 |

## MCP 工具参考

使用以下 Power BI 语义建模 MCP 操作：

| 操作类别 | 关键操作 |
|----------|----------|
| `连接操作` | 连接、列出连接、列出本地实例、连接 Fabric |
| `模型操作` | 获取、获取统计信息、导出 TMDL |
| `表操作` | 列出、获取、创建、更新、获取架构 |
| `列操作` | 列出、获取、创建、更新（描述、隐藏、格式） |
| `度量值操作` | 列出、获取、创建、更新、移动 |
| `关系操作` | 列出、获取、创建、更新、激活、停用 |
| `DAX 查询操作` | 执行、验证 |
| `计算组操作` | 列出、创建、更新 |
| `安全角色操作` | 列出、创建、更新、获取有效权限 |

## 常见任务

### 添加带描述的度量值
```
measure_operations(
  operation: "创建",
  定义: [{
    名称: "总销售额",
    表名: "销售",
    表达式: "SUM(销售[金额])",
    格式字符串: "$#,##0",
    描述: "所有销售金额的总和"
  }]
)
```

### 更新列描述
```
column_operations(
  operation: "更新",
  定义: [{
    表名: "客户",
    名称: "客户键",
    描述: "客户维度的唯一标识符",
    是否隐藏: true
  }]
)
```

### 创建关系
```
relationship_operations(
  operation: "创建",
  定义: [{
    来源表: "销售",
    来源列: "客户键",
    目标表: "客户",
    目标列: "客户键",
    跨筛选行为: "单向"
  }]
)
```
