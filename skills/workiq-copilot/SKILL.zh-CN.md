---
name: workiq-copilot
description: '指导Copilot命令行界面如何使用WorkIQ命令行界面/MCP服务器查询Microsoft 365 Copilot数据（电子邮件、会议、文档、Teams、人员），以获取实时上下文、摘要和建议。'
---

# WorkIQ Copilot技能

## 概述

WorkIQ（公开预览版）允许Copilot通过自然语言查询Microsoft 365数据。它支持日程安排、文档、Teams消息、电子邮件线程、跟进追踪、利益相关者摘要等功能。当任务需要超出本地仓库的实时组织智能时，请使用此技能。

## 支持的数据类型及示例提示

- **电子邮件** – “总结Sarah关于预算的电子邮件。”
- **会议** – “我本周有哪些即将举行的会议？”
- **文档** – “查找有关Q4规划的近期文档。”
- **Teams** – “总结今天Engineering频道的Teams消息。”
- **人员/项目** – “谁正在负责Project Alpha？”

## 获取访问权限

1. **Copilot CLI插件（推荐）**
   - `copilot`
   - `/plugin marketplace add github/copilot-plugins`
   - `/plugin install workiq@copilot-plugins`
   - 重启Copilot CLI。
2. **独立CLI / MCP服务器**
   - `npm install -g @microsoft/workiq`（或`npx -y @microsoft/workiq mcp`）。
   - 如果需要，运行`workiq mcp`以暴露MCP工具。
3. **租户授权**
   - 首次使用时，提示Microsoft 365管理员授权（EULA + 权限）。非管理员用户必须根据租户管理员启用指南联系租户管理员进行授权。

## 飞行前检查清单

- 运行`Get-Command workiq`以确保二进制文件可用。
- 通过`workiq accept-eula`接受EULA（首次使用）。
- 确认正确的租户（如果与默认租户`common`不同，请使用`-t <tenant-id>`）。
- 当提示时，准备好在浏览器中完成设备登录。

## 核心工作流程

1. **明确意图** – 日程安排、行动项、文档查找、人员搜索、风险摘要等。
2. **构建精确提示** – 包括时间范围、来源或主题（例如：“总结今天#eng频道的Teams帖子”）。
3. **运行命令** – `workiq ask --question "<提示>"`（如需可使用`-q`快捷方式）。
4. **监控执行** – 长答案可能会流式传输；在收到完整响应前，请勿发出其他请求。
5. **摘要与编辑** – 突出见解，记录冲突/任务，除非必要，否则避免粘贴原始链接。
6. **提供后续操作** – 安排专注时间、起草回复、深入查询等。

## 命令参考

| 命令                           | 用途                                                       |
| --------------------------------- | ------------------------------------------------------------- |
| `workiq --help`                   | 显示全局选项。                                          |
| `workiq version`                  | 显示已安装的版本。                                    |
| `workiq accept-eula`              | 接受许可协议（首次使用）。                                   |
| `workiq ask`                      | 交互模式。                                             |
| `workiq ask --question "..."`     | 询问特定问题（如需可使用`-q`快捷方式）。                        |
| `workiq ask -t <租户> -q "..."`   | 指定特定租户。                                         |
| `workiq mcp`                      | 启动MCP stdio服务器（将WorkIQ工具暴露给其他代理）。 |

## 提示模式

- **日程安排**：“明天我的日程安排是什么？”
- **行动项**：“总结今天客户同步会议的跟进内容。”
- **文档**：“列出有关Contoso FY26路线图的PowerPoint文档。”
- **沟通**：“我的经理关于截止日期说了什么？”
- **见解**：“过去三次会议中出现了哪些阻碍？”
- **规划**：“为周二下午建议专注时间段。”

## 响应指南

- 简洁总结（2-3句话），突出负载、优先级、阻碍及可选的下一步。
- 除非用户特别需要链接，否则应泛泛提及会议和文档。
- 提到WorkIQ是否可以继续（例如：“如果需要，WorkIQ可以显示周四至周日的信息”）。
- 将WorkIQ建议的操作映射为清晰的后续操作（安排时间、发送跟进、请求录像、执行更深入查询）。

## 最佳实践

- 优先使用狭窄的提示以减少噪音；如需，可运行多个查询。
- 在响应前逻辑地合并输出（日程安排 + 冲突 + 行动项）。
- 尊重隐私：除非用户明确要求，否则不要暴露与会者列表或机密片段。
- 记录运行的命令，以便未来步骤可以参考（例如：“已向WorkIQ询问日程安排 + 冲突”）。
- 当其他代理/工作流需要直接工具访问时，使用MCP模式（`workiq mcp`）。

## 常见问题排查

- **缺少CLI** – 通过npm安装或确保PATH已设置；如果不可用，请通知用户。
- **授权/认证错误** – 在管理员授予权限或完成设备登录后重新运行命令。
- **输出过长/不完整** – 重新运行时精简范围或请求特定数据切片（按天/项目/人员）。
- **命令卡住** – 在终端中取消正在运行的命令（例如使用Ctrl+C）或重启Copilot CLI会话，然后重试；确保浏览器登录已完成。

## 可提供的后续操作

- 在建议的时间段内安排专注/溢出保留时间。
- 起草参考WorkIQ指导的重新安排/拒绝消息。
- 请求重叠会议的录像或摘要。
- 将行动项捕获到任务跟踪器中。
- 通过项目、利益相关者或时间范围运行更多WorkIQ查询以进行深入分析。
